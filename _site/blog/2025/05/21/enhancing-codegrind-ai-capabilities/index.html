<!DOCTYPE html>
<html lang="en" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhancing CodeGrind's AI Capabilities: A Journey of Improvement | Riviera Sperduto - Developer Portfolio</title>
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Enhancing CodeGrind’s AI Capabilities: A Journey of Improvement | Riviera Sperduto - Developer Portfolio</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Enhancing CodeGrind’s AI Capabilities: A Journey of Improvement" />
<meta name="author" content="Riviera Sperduto" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this post, I’ll share the journey of enhancing CodeGrind’s AI capabilities, focusing on our recent improvements to the AI assistance system and the Tower Defense game integration. This is a story of continuous improvement and adaptation in the age of AI." />
<meta property="og:description" content="In this post, I’ll share the journey of enhancing CodeGrind’s AI capabilities, focusing on our recent improvements to the AI assistance system and the Tower Defense game integration. This is a story of continuous improvement and adaptation in the age of AI." />
<link rel="canonical" href="http://localhost:4000/blog/2025/05/21/enhancing-codegrind-ai-capabilities/" />
<meta property="og:url" content="http://localhost:4000/blog/2025/05/21/enhancing-codegrind-ai-capabilities/" />
<meta property="og:site_name" content="Riviera Sperduto - Developer Portfolio" />
<meta property="og:image" content="http://localhost:4000/assets/images/codegrind/ai-improvements-banner.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-05-21T13:00:00-04:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/images/codegrind/ai-improvements-banner.png" />
<meta property="twitter:title" content="Enhancing CodeGrind’s AI Capabilities: A Journey of Improvement" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@Riviera Sperduto" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/2025/05/21/enhancing-codegrind-ai-capabilities/"},"datePublished":"2025-05-21T13:00:00-04:00","@type":"BlogPosting","url":"http://localhost:4000/blog/2025/05/21/enhancing-codegrind-ai-capabilities/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/default-social-image.png"},"name":"Riviera Sperduto"},"description":"In this post, I’ll share the journey of enhancing CodeGrind’s AI capabilities, focusing on our recent improvements to the AI assistance system and the Tower Defense game integration. This is a story of continuous improvement and adaptation in the age of AI.","image":"http://localhost:4000/assets/images/codegrind/ai-improvements-banner.png","author":{"@type":"Person","name":"Riviera Sperduto"},"headline":"Enhancing CodeGrind’s AI Capabilities: A Journey of Improvement","dateModified":"2025-05-21T13:00:00-04:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    
    <!-- Google AdSense -->
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7733001105026476"
     crossorigin="anonymous"></script>
    
    
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/animations.css">
    <link rel="stylesheet" href="/assets/css/responsive.css">
    <link rel="stylesheet" href="/assets/css/dark-mode.css">
    <script>
        // Check for saved dark mode preference on page load
        if (localStorage.getItem('darkMode') === 'true') {
            document.documentElement.classList.add('dark');
        }
    </script>
</head>
<body class="page-transition enter-active">
    <!-- Skip to content link for accessibility -->
    <a href="#main-content" class="skip-to-content">Skip to main content</a>
    
    <header class="bg-gray-900 text-white shadow-md">
  <div class="container mx-auto px-4 py-4">
    <nav class="flex flex-wrap items-center justify-between">
      <!-- Logo/Site Title -->
      <a href="/" class="text-xl font-bold text-gray-400" aria-label="Home page">
        Riviera Sperduto
      </a>
      
      <div class="flex items-center">
        <!-- Dark Mode Toggle -->
        <button id="dark-mode-toggle" class="focus:outline-none mr-4" aria-label="Toggle dark mode">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 dark-mode-sun hidden dark:block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
          </svg>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 dark-mode-moon dark:hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
          </svg>
        </button>
      
        <!-- Mobile menu button -->
        <button id="menu-toggle" class="block md:hidden focus:outline-none" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="menu">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>
      
      <!-- Navigation Links -->
      <div id="menu" class="w-full md:w-auto hidden md:block" role="navigation" aria-label="Main navigation">
        <ul class="flex flex-col md:flex-row md:space-x-6 mt-4 md:mt-0">
          <li><a href="/" class="nav-link block py-2 md:py-0 text-gray-300 hover:text-blue-300" aria-label="Home">Home</a></li>
          <li><a href="/about/" class="nav-link block py-2 md:py-0 text-gray-300 hover:text-blue-300" aria-label="About">About</a></li>
          <li><a href="/projects/" class="nav-link block py-2 md:py-0 text-gray-300 hover:text-blue-300" aria-label="Projects">Projects</a></li>
          <li><a href="/services/" class="nav-link block py-2 md:py-0 text-gray-300 hover:text-blue-300" aria-label="Services">Services</a></li>
          <li><a href="/resume/" class="nav-link block py-2 md:py-0 text-gray-300 hover:text-blue-300" aria-label="Resume">Resume</a></li>
          <li><a href="/blog/" class="nav-link block py-2 md:py-0 text-gray-300 hover:text-blue-300" aria-label="Blog">Blog</a></li>
          <li><a href="/contact/" class="nav-link block py-2 md:py-0 text-gray-300 hover:text-blue-300" aria-label="Contact">Contact</a></li>
          <li><a href="/privacy/" class="nav-link block py-2 md:py-0 text-gray-300 hover:text-blue-300" aria-label="Privacy Policy">Privacy Policy</a></li>
        </ul>
      </div>
    </nav>
  </div>
</header>

<script>
  // Toggle mobile menu
  document.getElementById('menu-toggle').addEventListener('click', function() {
    document.getElementById('menu').classList.toggle('hidden');
    // Update aria-expanded state
    const isExpanded = !document.getElementById('menu').classList.contains('hidden');
    this.setAttribute('aria-expanded', isExpanded.toString());
  });
</script> 
    

    
<div class="header-ad-container w-full py-3 bg-gray-100 border-b border-gray-200 border-2 border-dashed border-gray-300">
  <div class="container mx-auto px-4 text-center">
    <p class="text-gray-500 text-sm mb-2">Advertisement</p>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-7733001105026476"
         data-ad-slot="4238838304"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </div>
</div>
 

    
    <main id="main-content" class="container mx-auto px-4 py-8">
        <article class="max-w-4xl mx-auto">
  <header class="mb-8 opacity-0" data-animate="fade-in">
    <h1 class="text-3xl md:text-4xl font-bold mb-4">Enhancing CodeGrind's AI Capabilities: A Journey of Improvement</h1>
    
    <div class="flex flex-wrap items-center text-gray-600 mb-6">
      <time datetime="2025-05-21T13:00:00-04:00" class="flex items-center mr-4 mb-2">
        <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"></path>
        </svg>
        May 21, 2025
      </time>
      
      
        <span class="flex items-center mr-4 mb-2">
          <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
          </svg>
          Riviera Sperduto
        </span>
      
      
      
        <span class="flex items-center mb-2">
          <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M17.707 9.293a1 1 0 010 1.414l-7 7a1 1 0 01-1.414 0l-7-7A.997.997 0 012 10V5a3 3 0 013-3h5c.256 0 .512.098.707.293l7 7zM5 6a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path>
          </svg>
          
            <a href="/categories/CodeGrind" class="hover:text-blue-600 transition-colors">CodeGrind</a>,&nbsp;
          
            <a href="/categories/Development" class="hover:text-blue-600 transition-colors">Development</a>,&nbsp;
          
            <a href="/categories/AI" class="hover:text-blue-600 transition-colors">AI</a>
          
        </span>
      
    </div>
    
    
      <div class="mb-6 rounded-lg overflow-hidden shadow-lg opacity-0" data-animate="fade-in" data-scroll="fade-up">
        <img src="/assets/images/codegrind/ai-improvements-banner.png" alt="Enhancing CodeGrind's AI Capabilities: A Journey of Improvement" class="w-full">
      </div>
    
  </header>
  
  <div class="prose prose-blue max-w-none mb-12 opacity-0 post-content" data-animate="fade-in" data-scroll="fade-up">
    <style>
/* Custom code block styling for this post */
.highlight {
  border-radius: 6px;
  margin: 1.5rem 0;
  padding: 0;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  overflow: auto;
}
.highlight pre {
  padding: 1.25rem;
  margin: 0;
  overflow-x: auto;
  line-height: 1.5;
}
.highlight code {
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
  font-size: 0.9rem;
}
html.dark .highlight {
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.4);
}
.solution-flex-row {
  display: flex;
  flex-direction: row;
  gap: 2%;
  width: 100%;
}
.solution-flex-row > div {
  width: 50%;
  min-width: 0;
}
@media (max-width: 700px) {
  .solution-flex-row {
    flex-direction: column;
  }
  .solution-flex-row > div {
    width: 100%;
  }
}
/* Spinner and loading button styles */
.button--loading {
  position: relative;
  pointer-events: none;
  opacity: 0.7;
}
.button--loading .button__text {
  visibility: hidden;
  opacity: 0;
}
.button--loading .spinner {
  display: block;
}
.spinner {
  display: none;
  position: absolute;
  left: 50%;
  top: 50%;
  width: 20px;
  height: 20px;
  margin-left: -10px;
  margin-top: -10px;
  border: 3px solid #fff;
  border-top: 3px solid #38bdf8;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  z-index: 2;
}
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
/* Force code blocks and pre elements in hack assistant to wrap */
#hack-chat-log pre,
#hack-chat-log code {
  white-space: pre-wrap !important;
  word-break: break-word !important;
  overflow-wrap: anywhere !important;
  box-sizing: border-box;
  max-width: 100%;
}
.bg-purple-100 pre,
.bg-purple-100 code {
  white-space: pre-wrap !important;
  word-break: break-word !important;
  overflow-wrap: anywhere !important;
  box-sizing: border-box;
  max-width: 100%;
}
</style>

<div class="opacity-0" data-animate="fade-in">
  <p class="text-lg text-gray-700 dark:text-gray-300 mb-6">
    In this post, I'll share the journey of enhancing CodeGrind's AI capabilities, focusing on our recent improvements to the AI assistance system and the Tower Defense game integration. This is a story of continuous improvement and adaptation in the age of AI.
  </p>
  <div class="flex flex-col md:flex-row gap-4 mb-8">
    <a href="https://codegrind.online/" class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg shadow transition-colors text-center">Visit CodeGrind</a>
    <a href="https://codegrind.online/games/tower-defense/demo/two-sum" class="inline-block bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-lg shadow transition-colors text-center">Try the Tower Defense Demo</a>
  </div>
  
<div class="blog-sidebar-ad my-8 border-2 border-dashed border-gray-300 p-4 rounded text-center bg-gray-100">
  <h4 class="text-sm uppercase text-gray-500 mb-2">Sponsored Content</h4>
  <div class="bg-white p-2 rounded shadow">
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7733001105026476" data-ad-slot="5855397645" data-ad-format="auto" data-full-width-responsive="true"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </div>
</div>
 

  <h2 class="text-2xl font-bold mt-8 mb-4 text-gray-900 dark:text-white">The Evolution of AI Assistance</h2>
  <h3 class="text-xl font-bold mt-6 mb-3 text-gray-900 dark:text-white">Initial Implementation</h3>
  <ul class="list-disc ml-8 text-gray-700 dark:text-gray-300">
    <li>Basic code completion</li>
    <li>Simple error explanations</li>
    <li>Limited context awareness</li>
  </ul>
  <h3 class="text-xl font-bold mt-6 mb-3 text-gray-900 dark:text-white">Major Improvements</h3>
  <ul class="list-disc ml-8 text-gray-700 dark:text-gray-300">
    <li>Context-aware code suggestions</li>
    <li>Intelligent error analysis</li>
    <li>Learning path recommendations</li>
    <li>Real-time code optimization tips</li>
  </ul>
</div>

<div class="opacity-0" data-animate="fade-in">
  <h2 class="text-2xl font-bold mt-8 mb-4 text-gray-900 dark:text-white">Tower Defense AI Integration</h2>
  <h3 class="text-xl font-bold mt-6 mb-3 text-gray-900 dark:text-white">Code Generation System</h3>
  <ul class="list-disc ml-8 text-gray-700 dark:text-gray-300">
    <li>AI-generated code snippets for tower behaviors</li>
    <li>Dynamic difficulty adjustment</li>
    <li>Personalized challenge generation</li>
    <li>Smart hint system</li>
  </ul>
  <img src="/assets/images/codegrind/tower-defense.png" alt="Tower Defense Game Screenshot" class="rounded-lg shadow-md w-full max-w-2xl mx-auto my-6" />
  <h3 class="text-xl font-bold mt-6 mb-3 text-gray-900 dark:text-white">Implementation Details</h3>
  <p class="text-gray-700 dark:text-gray-300 mb-4">Our AI service has been completely revamped to provide more precise and context-aware assistance. Here's how it works:</p>
  <pre class="highlight"><code class="language-javascript">// Core AI service structure
class AIService {
  constructor() {
    this.client = new AzureOpenAI({
      endpoint: process.env.AZURE_OPENAI_ENDPOINT,
      apiKey: process.env.AZURE_OPENAI_API_KEY,
      apiVersion: "2024-02-15-preview",
      deployment: process.env.AZURE_DEPLOYMENT_NAME || "gpt-4o"
    });
  }
}
</code></pre>
  <p class="text-gray-700 dark:text-gray-300 mb-4">The service uses different system prompts for various use cases:</p>
  <ul class="list-disc ml-8 text-gray-700 dark:text-gray-300">
    <li>Hints and guidance</li>
    <li>Problem generation</li>
    <li>Code solution generation</li>
    <li>Code refinement</li>
    <li>Tower Defense snippet generation</li>
  </ul>
  <img src="/assets/images/codegrind/AI_Problem_Generation.png" alt="AI Problem Generation" class="rounded-lg shadow-md w-full max-w-2xl mx-auto my-6" />

  <p class="text-gray-700 dark:text-gray-300 mb-4">
    <strong>More on Problem Generation:</strong> Our advanced problem generation system empowers users to not only create custom programming challenges, but also to fully control the problem creation process. After generating a problem, you can review and edit every part of it—including the description, function signature, test cases, and even the expected outputs. To ensure quality and fairness, you must also provide a working solution for your problem, which is automatically tested before you can submit it to the platform. If you get stuck, you can use the integrated AI chat assistant for hints, debugging help, or even step-by-step guidance to solve your own problem. This makes the process both educational and interactive, whether you're learning or challenging others.<br />
    <br />
    <em>More information and an interactive demo of this feature are coming soon—stay tuned!</em>
  </p>

  <img src="/assets/images/codegrind/tower-defense-solution-verified.png" alt="Tower Defense Solution Verified" class="rounded-lg shadow-md w-full max-w-2xl mx-auto my-6" />
</div>

<div class="opacity-0" data-scroll="fade-up">
  <h2 class="text-2xl font-bold mt-8 mb-4 text-gray-900 dark:text-white">Interactive Demo: Build a Solution (Tower Defense Style)</h2>
  <div class="mb-4 p-4 bg-blue-100 dark:bg-slate-700 rounded-lg text-gray-800 dark:text-gray-200">
    <strong>How to use this demo:</strong> Select a tower type (programming concept), view its stats and upgrades, and add it to your solution. Compare how the <span class="text-blue-700 font-semibold">Old AI</span> and <span class="text-green-700 font-semibold">New AI</span> would generate code for each tower. Build your solution step-by-step, just like in the real Tower Defense game!<br />Notice how the old and new snippets generated are different, you can see that the old snippet generation would at times give a whole solution but the new snippet generation will actually give you the proper code for the programming concept you are trying to add to your solution.<br />
    <span class="block mt-2">Need help? Use the <span class="text-purple-400 font-semibold">Hack Assistant</span> (bottom right) to get hints, step-by-step help, or even a full solution!</span><br />When you are ready to submit your solution, click the <span class="text-green-700 font-semibold">Test Solution</span> button to see if your solution is correct.
  </div>
  <div class="rounded-lg shadow-md bg-blue-50 dark:bg-slate-800 p-6 my-6 max-w-2xl mx-auto relative">
    <h3 class="text-lg font-bold mb-4 text-gray-900 dark:text-white">LeetCode Problem: Two Sum</h3>
    <p class="text-gray-700 dark:text-gray-300 mb-2">Given an array of integers <code>nums</code> and an integer <code>target</code>, return indices of the two numbers such that they add up to <code>target</code>.<br />You may assume that each input would have exactly one solution, and you may not use the same element twice.</p>
    <a href="https://codegrind.online/games/tower-defense/demo/two-sum" class="text-blue-600 hover:text-blue-800 underline text-sm mb-4 inline-block">Try this problem in the real Tower Defense game &rarr;</a>
    <div class="mb-4">
      <label for="tower-select" class="font-medium text-gray-800 dark:text-gray-200">Choose next tower type:</label>
      <select id="tower-select" class="ml-2 mb-2 rounded border-gray-300 dark:bg-slate-700 dark:text-white">
        <option value="default" selected="">Select a tower type</option>
        <option value="ForLoop">ForLoop</option>
        <option value="WhileLoop">WhileLoop</option>
        <option value="IfCondition">IfCondition</option>
        <option value="Variable">Variable</option>
        <option value="Function">Function</option>
        <option value="Array">Array</option>
        <option value="Object">Object</option>
        <option value="Return">Return</option>
        <option value="TryCatch">TryCatch</option>
        <option value="Switch">Switch</option>
      </select>
      <button id="add-tower" class="ml-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-1 px-4 rounded transition-colors">Add Tower</button>
    </div>
    <div id="tower-info" class="mb-4 p-4 rounded bg-white dark:bg-slate-900 shadow text-sm"></div>
    <div class="flex flex-col md:flex-row gap-4 mb-4">
      <div class="flex-1">
        <h4 class="font-semibold text-blue-700 dark:text-blue-600 mb-2">Old AI Snippet</h4>
        <div id="old-snippet" class="bg-slate-900 text-blue-400 rounded p-4 min-h-[2.5rem] text-base mb-2"></div>
      </div>
      <div class="flex-1">
        <h4 class="font-semibold text-green-700 dark:text-green-800 mb-2">New AI Snippet</h4>
        <div id="new-snippet" class="bg-slate-900 text-green-400 rounded p-4 min-h-[2.5rem] text-base mb-2"></div>
      </div>
    </div>
    <div>
      <h4 class="font-semibold text-gray-900 dark:text-white mb-2">Your Solution (as built):</h4>
      <div class="mb-2">
        <button id="clear-old" class="mr-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-1 px-2 rounded">Clear Old</button>
        <button id="clear-new" class="mr-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-1 px-2 rounded">Clear New</button>
        <button id="clear-both" class="mr-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-1 px-2 rounded">Clear Both</button>
        <button id="toggle-both" class="bg-blue-200 hover:bg-blue-300 text-blue-800 font-semibold py-1 px-2 rounded">Show/Hide Both</button>
      </div>
      <div class="solution-flex-row">
        <div id="old-solution-preview" class="bg-slate-800 text-blue-400 rounded p-4 min-h-[3rem] text-base overflow-auto" style="white-space: pre; font-family: 'Consolas', 'Monaco', 'Courier New', monospace;"></div>
        <div id="solution-preview" class="bg-slate-800 text-green-400 rounded p-4 min-h-[3rem] text-base overflow-auto" style="white-space: pre; font-family: 'Consolas', 'Monaco', 'Courier New', monospace;"></div>
      </div>
      <button id="test-solution" class="mt-4 bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-6 rounded transition-colors">Test Solution</button>
      <div id="test-result" class="mt-4 text-base font-semibold"></div>
    </div>
    <!-- Hack Assistant UI - Static Integration -->
    <div id="hack-assistant-static" class="mt-8 p-6 bg-slate-900 rounded-lg shadow-xl border border-purple-700">
      <div id="hack-assistant-header-static" class="flex items-center justify-between pb-3 border-b border-purple-600">
        <h3 class="text-xl font-bold text-purple-700 flex items-center">
          <span class="mr-3 text-2xl">&#129302;</span> <!-- Robot emoji -->
          Hack Assistant
        </h3>
      </div>
      <div id="hack-assistant-body-static" class="mt-4 space-y-5">
        <div>
          <label for="assist-level-static" class="block mb-1 text-sm font-bold text-purple-600">Assistance Level:</label>
          <select id="assist-level-static" class="w-full p-2.5 rounded bg-slate-800 text-green-600 border border-purple-600 focus:ring-purple-500 focus:border-purple-500 font-mono text-sm shadow-inner">
            <option class="text-green-600">Hints Only - Get hints and guidance, but never full code.</option>
            <option class="text-green-600">Full Solution - Receive a complete code solution.</option>
            <option class="text-green-600">Step-by-Step - Get a solution broken down into logical steps.</option>
            <option class="text-green-600">Debug Mode - Get help identifying and fixing bugs in your code.</option>
            <option class="text-green-600">Learning Mode - Get explanations and teaching for concepts and code.</option>
          </select>
        </div>
        <div id="hack-chat-static" class="p-4 min-h-[100px] bg-slate-950 rounded border border-purple-700 shadow-inner">
          <p id="hack-chat-msg-static" class="text-sm text-purple-500 font-bold leading-relaxed">Greetings, hacker. I'm your neural infiltration assistant. How can I aid in your system breach today?</p>
        </div>
        <div class="flex items-center gap-3">
          <input id="hack-input-static" type="text" placeholder="Awaiting your command..." class="flex-grow p-2.5 rounded bg-slate-800 text-purple-800 border border-purple-600 focus:ring-purple-500 focus:border-purple-500 font-mono text-sm shadow-inner" />
          <button id="transmit-btn-static" class="px-6 py-2.5 rounded bg-purple-600 hover:bg-purple-700 text-white font-semibold font-mono text-sm transition-colors shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50">Transmit</button>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="opacity-0" data-scroll="fade-up">
  <h2 class="text-2xl font-bold mt-8 mb-4 text-gray-900 dark:text-white">Technical Implementation</h2>
  <h3 class="text-xl font-bold mt-6 mb-3 text-gray-900 dark:text-white">AI Service Architecture</h3>
  <p class="text-gray-700 dark:text-gray-300 mb-4">Our AI service is built with modularity and extensibility in mind:</p>
  <pre class="highlight"><code class="language-javascript">const SYSTEM_PROMPTS = {
  hints: {
    role: "system",
    content: "You are CodeGrind's AI teaching assistant. Your role is to help users learn programming concepts and problem-solving strategies, but never to provide direct code solutions."
  },
  problemGeneration: {
    role: "system",
    content: "You are a programming problem generator for CodeGrind. You're designed to create high-quality programming problems in JSON format."
  },
  // ... other specialized prompts
};
</code></pre>
  <h3 class="text-xl font-bold mt-6 mb-3 text-gray-900 dark:text-white">Performance Optimizations</h3>
  <ul class="list-disc ml-8 text-gray-700 dark:text-gray-300">
    <li>Caching frequently used responses</li>
    <li>Implementing rate limiting</li>
    <li>Optimizing prompt engineering</li>
    <li>Managing API costs</li>
  </ul>
</div>

<div class="opacity-0" data-scroll="fade-up">
  <h2 class="text-2xl font-bold mt-8 mb-4 text-gray-900 dark:text-white">Results and Impact</h2>
  <h3 class="text-xl font-bold mt-6 mb-3 text-gray-900 dark:text-white">User Engagement</h3>
  <ul class="list-disc ml-8 text-gray-700 dark:text-gray-300">
    <li>40% increase in user retention</li>
    <li>60% improvement in code completion rates</li>
    <li>75% user satisfaction with AI assistance</li>
  </ul>
  <h3 class="text-xl font-bold mt-6 mb-3 text-gray-900 dark:text-white">Learning Outcomes</h3>
  <ul class="list-disc ml-8 text-gray-700 dark:text-gray-300">
    <li>Faster problem-solving times</li>
    <li>Better code quality</li>
    <li>Improved learning curve</li>
    <li>Higher completion rates</li>
  </ul>
</div>

<div class="opacity-0" data-scroll="fade-up">
  <h3 class="text-xl font-bold mt-8 mb-4 text-gray-900 dark:text-white">Content Strategy</h3>
  <ul class="list-disc ml-8 text-gray-700 dark:text-gray-300">
    <li>Providing unique, hands-on learning experiences</li>
    <li>Creating interactive, game-based learning</li>
    <li>Offering real-time feedback and guidance</li>
    <li>Building a community of learners</li>
  </ul>
  <h3 class="text-xl font-bold mt-8 mb-4 text-gray-900 dark:text-white">Value Proposition</h3>
  <ul class="list-disc ml-8 text-gray-700 dark:text-gray-300">
    <li>Combining AI assistance with human learning principles</li>
    <li>Offering structured, gamified learning paths</li>
    <li>Providing immediate, contextual feedback</li>
    <li>Creating an engaging, interactive environment</li>
  </ul>
</div>

<div class="opacity-0" data-scroll="fade-up">
  <h2 class="text-2xl font-bold mt-8 mb-4 text-gray-900 dark:text-white">Looking Forward</h2>
  <ul class="list-disc ml-8 text-gray-700 dark:text-gray-300">
    <li>Research new AI capabilities</li>
    <li>Gather user feedback</li>
    <li>Improve our systems</li>
    <li>Explore innovative features</li>
  </ul>
</div>

<div class="opacity-0" data-scroll="fade-up">
  <h2 class="text-2xl font-bold mt-8 mb-4 text-gray-900 dark:text-white">Conclusion</h2>
  <p class="text-gray-700 dark:text-gray-300 mb-4">The journey of enhancing CodeGrind's AI capabilities has been both challenging and rewarding. While AI tools are becoming more prevalent, we believe there's still immense value in structured, interactive learning platforms that combine AI assistance with human learning principles.</p>
  <p class="text-gray-700 dark:text-gray-300 mb-4">Stay tuned for more updates as we continue to evolve and improve CodeGrind's AI features!</p>
</div>
<p><br />
<br /></p>
<div class="opacity-0" data-scroll="fade-up">
  <p class="text-gray-700 dark:text-gray-300 mt-8">*Want to experience these AI improvements firsthand? Try CodeGrind at <a href="https://codegrind.online" class="text-blue-600 hover:text-blue-800">codegrind.online</a>.*</p>
</div>

  </div>
  
  <!-- In-article ad after content -->
  


  
      <div class="adsense-container my-4 border-2 border-dashed border-gray-300 p-4 rounded text-center bg-gray-100">
        <p class="text-gray-500 text-sm mb-2">Advertisement</p>
        <ins class="adsbygoogle"
             style="display:block; text-align:center;"
             data-ad-layout="in-article"
             data-ad-format="fluid"
             data-ad-client="ca-pub-7733001105026476"
             data-ad-slot="YOUR_IN_ARTICLE_SLOT_ID"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>
    
    
 
  
  
    <div class="mb-8 pb-8 border-b opacity-0" data-animate="fade-in" data-scroll="fade-up">
      <h3 class="text-lg font-bold mb-4">Tags</h3>
      <div class="flex flex-wrap gap-2">
        
          <a href="/tag/CodeGrind" class="bg-gray-100 hover:bg-gray-200 text-gray-800 text-sm font-medium py-1 px-2 rounded transition-colors">
            #CodeGrind
          </a>
        
          <a href="/tag/AI%20Integration" class="bg-gray-100 hover:bg-gray-200 text-gray-800 text-sm font-medium py-1 px-2 rounded transition-colors">
            #AI Integration
          </a>
        
          <a href="/tag/OpenAI" class="bg-gray-100 hover:bg-gray-200 text-gray-800 text-sm font-medium py-1 px-2 rounded transition-colors">
            #OpenAI
          </a>
        
          <a href="/tag/AI%20Collaboration" class="bg-gray-100 hover:bg-gray-200 text-gray-800 text-sm font-medium py-1 px-2 rounded transition-colors">
            #AI Collaboration
          </a>
        
          <a href="/tag/Real-Time%20Execution" class="bg-gray-100 hover:bg-gray-200 text-gray-800 text-sm font-medium py-1 px-2 rounded transition-colors">
            #Real-Time Execution
          </a>
        
          <a href="/tag/Learning%20Platform" class="bg-gray-100 hover:bg-gray-200 text-gray-800 text-sm font-medium py-1 px-2 rounded transition-colors">
            #Learning Platform
          </a>
        
      </div>
    </div>
  
  
  <div class="flex justify-between items-center mb-8 opacity-0" data-animate="fade-in" data-scroll="fade-up">
    <a href="/blog/" class="inline-flex items-center text-blue-600 hover:text-blue-800 font-medium">
      <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
      </svg>
      Back to all posts
    </a>
    
    <div class="flex space-x-4">
      <a href="https://twitter.com/intent/tweet?text=Enhancing+CodeGrind%27s+AI+Capabilities%3A+A+Journey+of+Improvement&url=http%3A%2F%2Flocalhost%3A4000%2Fblog%2F2025%2F05%2F21%2Fenhancing-codegrind-ai-capabilities%2F" target="_blank" rel="noopener noreferrer" class="text-blue-500 hover:text-blue-700">
        <span class="sr-only">Share on Twitter</span>
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path>
        </svg>
      </a>
      <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fblog%2F2025%2F05%2F21%2Fenhancing-codegrind-ai-capabilities%2F&title=Enhancing+CodeGrind%27s+AI+Capabilities%3A+A+Journey+of+Improvement" target="_blank" rel="noopener noreferrer" class="text-blue-700 hover:text-blue-900">
        <span class="sr-only">Share on LinkedIn</span>
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path>
        </svg>
      </a>
      <a href="https://bsky.app/intent/compose?text=Enhancing+CodeGrind%27s+AI+Capabilities%3A+A+Journey+of+Improvement%20http%3A%2F%2Flocalhost%3A4000%2Fblog%2F2025%2F05%2F21%2Fenhancing-codegrind-ai-capabilities%2F" target="_blank" rel="noopener noreferrer" class="text-blue-500 hover:text-blue-700">
        <span class="sr-only">Share on Bluesky</span>
        <svg class="w-6 h-6" fill="none" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
          <path fill="#0085ff" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022 0 8.51 0 6.55 0-3.268 8.579-.182 13.873 3.805ZM50.127 3.805C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745Z"></path>
        </svg>
      </a>
    </div>
  </div>
  
  
    
    <div class="mt-12 mb-8 opacity-0" data-animate="fade-in" data-scroll="fade-up">
      <h3 class="text-2xl font-bold mb-6">Related Posts</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        
          <div class="bg-white rounded-lg shadow-md overflow-hidden transition-all hover:shadow-lg opacity-0" data-animate="fade-in" data-scroll="fade-up">
            <div class="p-6">
              <h4 class="text-lg font-bold mb-2">
                <a href="/blog/2025/05/20/the-tech-stack-behind-codegrind/" class="text-gray-900 hover:text-blue-600">The Tech Stack Behind CodeGrind</a>
              </h4>
              <div class="text-gray-600 text-sm mb-3">
                <time datetime="2025-05-20T13:00:00-04:00">May 20, 2025</time>
              </div>
              <p class="text-gray-600 mb-4">In my previous post, I introduced CodeGrind as a modern coding practice platform. Today, I’ll share the actual technical architecture...</p>
              <a href="/blog/2025/05/20/the-tech-stack-behind-codegrind/" class="text-blue-600 hover:text-blue-800 font-medium inline-flex items-center">
                Read more
                <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
                </svg>
              </a>
            </div>
          </div>
        
          <div class="bg-white rounded-lg shadow-md overflow-hidden transition-all hover:shadow-lg opacity-0" data-animate="fade-in" data-scroll="fade-up">
            <div class="p-6">
              <h4 class="text-lg font-bold mb-2">
                <a href="/blog/2025/05/19/introducing-codegrind-a-new-way-to-practice-coding/" class="text-gray-900 hover:text-blue-600">Introducing CodeGrind: A New Way to Practice Coding</a>
              </h4>
              <div class="text-gray-600 text-sm mb-3">
                <time datetime="2025-05-19T11:00:00-04:00">May 19, 2025</time>
              </div>
              <p class="text-gray-600 mb-4">
</p>
              <a href="/blog/2025/05/19/introducing-codegrind-a-new-way-to-practice-coding/" class="text-blue-600 hover:text-blue-800 font-medium inline-flex items-center">
                Read more
                <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
                </svg>
              </a>
            </div>
          </div>
        
        
    
      </div>
      <!-- Display ad after related posts -->
      


  
      <div class="adsense-container my-4 border-2 border-dashed border-gray-300 p-4 rounded text-center bg-gray-100">
        <p class="text-gray-500 text-sm mb-2">Advertisement</p>
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-7733001105026476"
             data-ad-slot="YOUR_DISPLAY_AD_SLOT_ID"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>
    
    
 
    </div>
  
  
  <div class="mt-8 bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg shadow-sm opacity-0" data-animate="fade-in" data-scroll="fade-up">
    <h3 class="text-xl font-bold mb-4">Subscribe for Updates</h3>
    <p class="mb-4 text-gray-700">Get notified when new articles are published. No spam, just valuable content.</p>
    
    <!-- Mailchimp Signup Form -->
    <div id="mc_embed_shell" class="bg-white p-5 rounded-lg shadow-md">
      <link href="//cdn-images.mailchimp.com/embedcode/classic-061523.css" rel="stylesheet" type="text/css">
  <style type="text/css">
        #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width: 100%; max-width: 600px; border-radius: 0.5rem;}
        /* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
           We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
    <form action="https://github.us14.list-manage.com/subscribe/post?u=4c5f3cb9e9f5dfc6c64a01f23&amp;id=28ff2a557d&amp;f_id=00c351e0f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank">
        <div id="mc_embed_signup_scroll"><h2>Subscribe</h2>
            <div class="indicates-required"><span class="asterisk">*</span> indicates required</div>
            <div class="mc-field-group"><label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label><input type="email" name="EMAIL" class="required email" id="mce-EMAIL" required="" value=""></div>
        <div id="mce-responses" class="clear foot">
            <div class="response" id="mce-error-response" style="display: none;"></div>
            <div class="response" id="mce-success-response" style="display: none;"></div>
        </div>
    <div aria-hidden="true" style="position: absolute; left: -5000px;">
        <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups -->
        <input type="text" name="b_4c5f3cb9e9f5dfc6c64a01f23_28ff2a557d" tabindex="-1" value="">
    </div>
        <div class="optionalParent">
            <div class="clear foot">
                <input type="submit" name="subscribe" id="mc-embedded-subscribe" class="button" value="Subscribe">
                <p style="margin: 0px auto;"><a href="http://eepurl.com/jdZ9VY" title="Mailchimp - email marketing made easy and fun"><span style="display: inline-block; background-color: transparent; border-radius: 4px;"><img class="refferal_badge" src="https://digitalasset.intuit.com/render/content/dam/intuit/mc-fe/en_us/images/intuit-mc-rewards-text-dark.svg" alt="Intuit Mailchimp" style="width: 220px; height: 40px; display: flex; padding: 2px 0px; justify-content: center; align-items: center;"></span></a></p>
            </div>
        </div>
    </div>
</form>
</div>
<script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';fnames[3]='ADDRESS';ftypes[3]='address';fnames[4]='PHONE';ftypes[4]='phone';fnames[5]='BIRTHDAY';ftypes[5]='birthday';fnames[6]='COMPANY';ftypes[6]='text';}(jQuery));var $mcj = jQuery.noConflict(true);</script></div>
    <!--End Mailchimp-->
  </div>
</article> 

<!-- Endpoint configuration -->
<div id="endpoints" 
  data-new-chat="https://blogpost-interactive-elements.azurewebsites.net/api/NewMethodProxy/chat?code=nD1a46NHMxN4lXjwU9QlyF1n6oocEufMHX3pISfh11XZAzFu9hxvhg=="
  data-new-snippet="https://blogpost-interactive-elements.azurewebsites.net/api/NewMethodProxy/tower-snippet?code=nD1a46NHMxN4lXjwU9QlyF1n6oocEufMHX3pISfh11XZAzFu9hxvhg=="
  data-old-chat="https://blogpost-interactive-elements.azurewebsites.net/api/OldMethodProxy/chat?code=-4TTQHaCTQowUPWEVHledCxSibCXKw7CXn_4p4UeaNOeAzFuWX3yug=="
  data-old-snippet="https://blogpost-interactive-elements.azurewebsites.net/api/OldMethodProxy/tower-snippet?code=-4TTQHaCTQowUPWEVHledCxSibCXKw7CXn_4p4UeaNOeAzFuWX3yug=="
  data-execute-two-sum="https://blogpost-interactive-elements.azurewebsites.net/api/ExecuteTwoSumSolutionProxy?code=Sjz5G5JK3TtZpXDR8KeUtG8lAdyEq6yGdcJk0pgbPWZZAzFuepwheg=="
  style="display: none;">
</div> 
<script>
// Add global arrays for old and new solutions
const TWO_SUM_SKELETON = [
  'from typing import List',
  '',
  'class Solution:',
  '    def twoSum(self, nums: List[int], target: int) -> List[int]:',
  '        # Write your code below'
];
let builtSolutionOld = [...TWO_SUM_SKELETON];
let builtSolutionNew = [...TWO_SUM_SKELETON];

// Add global object for per-endpoint rate limits
let rateLimits = {
  old: { requests: null, reset: null, timer: null },
  new: { requests: null, reset: null, timer: null },
  execute: { requests: null, reset: null, timer: null }
};

// Add spinner styles
const spinnerStyles = `
<style>
.button--loading {
    position: relative;
    color: transparent !important;
    pointer-events: none;
}

.button--loading .spinner {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 20px;
    height: 20px;
    border: 3px solid #ffffff;
    border-radius: 50%;
    border-top-color: transparent;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    to {
        transform: translate(-50%, -50%) rotate(360deg);
    }
}
</style>
`;

// Add spinner styles to document
document.head.insertAdjacentHTML('beforeend', spinnerStyles);

// In-memory chat history for Hack Assistant
let hackChatHistory = [
  { role: 'assistant', content: "Greetings, hacker. I'm your neural infiltration assistant. How can I aid in your system breach today?" }
];

// Add a function to show rate limit info and countdown for all endpoints
function showRateLimitInfo(endpoint, requests, seconds) {
  if (!rateLimits[endpoint]) {
    rateLimits[endpoint] = { requests: null, reset: null, timer: null };
  }
  rateLimits[endpoint].requests = requests;
  rateLimits[endpoint].reset = seconds;
  const infoDiv = document.getElementById('rate-limit-info');
  if (!infoDiv) return;
  // Clear any previous timer for this endpoint
  if (rateLimits[endpoint].timer) {
    clearInterval(rateLimits[endpoint].timer);
    rateLimits[endpoint].timer = null;
  }
  // Build display for all endpoints
  let html = '';
  Object.entries(rateLimits).forEach(([key, val]) => {
    let label = key === 'old' ? 'Old AI' : key === 'new' ? 'New AI' : 'Test Solution';
    if (val.requests === null || val.reset === null) return;
    if (val.requests === 0) {
      html += `${label}: Rate limit reached. Try again in <span id="rate-timer-${key}">${val.reset}</span> seconds.<br/>`;
      let remaining = val.reset;
      rateLimits[key].timer = setInterval(() => {
        remaining--;
        const timerSpan = document.getElementById(`rate-timer-${key}`);
        if (timerSpan) timerSpan.textContent = remaining;
        if (remaining <= 0) {
          clearInterval(rateLimits[key].timer);
          rateLimits[key].timer = null;
          // Optionally, reset display after timer expires
          // infoDiv.textContent = '';
        }
      }, 1000);
    } else {
      html += `${label}: Requests left: ${val.requests}.`;
      if (val.reset > 0) html += ` (refresh in ${val.reset}s)`;
      html += '<br/>';
    }
  });
  infoDiv.innerHTML = html;
}

// Add a global logging utility
function logApiCall(label, details) {
  try {
    //console.log(`[API LOG] ${label}:`, JSON.stringify(details, null, 2));
  } catch (e) {
    //console.log(`[API LOG] ${label}:`, details);
  }
}

// Update handleApiResponse to show rate limit info for a given endpoint
async function handleApiResponse(response, endpointKey) {
  logApiCall('handleApiResponse - response', {
    status: response.status,
    statusText: response.statusText,
    headers: [...response.headers.entries()],
  });
  let data;
  const text = await response.text();
  logApiCall('handleApiResponse - raw text', { text });
  try {
    data = text ? JSON.parse(text) : {};
  } catch (e) {
    // If the response is the VM not ready message, handle it gracefully
    if (text && text.includes('Judge0 VM is not ready')) {
      data = { error: 'Judge0 VM is not ready' };
    } else {
      logApiCall('handleApiResponse - parse error', { error: e });
      data = { error: "Invalid server response." };
    }
  }
  if (endpointKey && data.requests_remaining !== undefined && data.reset_seconds !== undefined) {
    showRateLimitInfo(endpointKey, data.requests_remaining, data.reset_seconds);
  }
  if (!response.ok || data.error) {
    logApiCall('handleApiResponse - error', { error: data.error, status: response.status });
    // If the error is Judge0 VM is not ready, throw a special error so pollAndRetry can catch it
    if (data.error && data.error.includes('Judge0 VM is not ready')) {
      throw new Error('Judge0 VM is not ready');
    }
    throw new Error(data.error || `API request failed: ${response.status} ${response.statusText}`);
  }
  logApiCall('handleApiResponse - success', { data });
  return data;
}

// Add loading indicators for snippets
function setSnippetLoading() {
  const oldSnippetElement = document.getElementById('old-snippet');
  const newSnippetElement = document.getElementById('new-snippet');
  if (oldSnippetElement) oldSnippetElement.textContent = 'Loading...';
  if (newSnippetElement) newSnippetElement.textContent = 'Loading...';
}

const towers = {
  ForLoop: {
    name: "For Loop",
    desc: "Attacks multiple enemies in a sequence",
    cost: 50,
    dmg: 12,
    rng: 3,
    spd: 1.2,
    upgrades: ["Faster Iteration", "Enhanced Range", "+1 more"]
  },
  WhileLoop: {
    name: "While Loop",
    desc: "Continuous attack on a single path",
    cost: 75,
    dmg: 8,
    rng: 2,
    spd: 2.5,
    upgrades: ["Condition Enhancement", "Break Statement"]
  },
  IfCondition: {
    name: "If Condition",
    desc: "Attacks based on enemy type",
    cost: 40,
    dmg: 12,
    rng: 2,
    spd: 1,
    upgrades: ["Additional Branch", "ElIf Statement"]
  },
  Variable: {
    name: "Variable",
    desc: "Stores enemy information, enhances nearby towers",
    cost: 30,
    dmg: 7,
    rng: 4,
    spd: 0.8,
    upgrades: ["Type Specifialization", "Constant Declaration"]
  },
  Function: {
    name: "Function",
    desc: "Reusable attack pattern with high damage",
    cost: 100,
    dmg: 35,
    rng: 3,
    spd: 0.7,
    upgrades: ["Parameter Expansion", "Recursive Function"]
  },
  Array: {
    name: "Array",
    desc: "Fires multiple shots in array pattern",
    cost: 80,
    dmg: 10,
    rng: 4,
    spd: 1,
    upgrades: ["Sorting Attack", "Mapping Attack", "+1 more"]
  },
  Object: {
    name: "Object",
    desc: "Creates damage fields that persist",
    cost: 110,
    dmg: 25,
    rng: 3,
    spd: 0.6,
    upgrades: ["Inheritance Boost", "Polymorphic Attack", "+1 more"]
  },
  Return: {
    name: "Return",
    desc: "High damage with knockback effect",
    cost: 120,
    dmg: 30,
    rng: 2,
    spd: 0.5,
    upgrades: ["Early Return", "Multiple Returns"]
  },
  TryCatch: {
    name: "Try/Catch",
    desc: "Traps enemies and deals damage over time.",
    cost: 65,
    dmg: 10,
    rng: 3,
    spd: 0.5,
    upgrades: ["Error Handling", "Finally Block"]
  },
  Switch: {
    name: "Switch",
    desc: "Switches attack pattern based on enemies",
    cost: 60,
    dmg: 15,
    rng: 3,
    spd: 0.9,
    upgrades: ["Multiple Cases", "Default Case"]
  }
};

class InteractiveElements {
    constructor() {
        this.ENDPOINTS = {
          newChat: document.getElementById('endpoints')?.dataset.newChat || '/api/fallback',
          newSnippet: document.getElementById('endpoints')?.dataset.newSnippet || '/api/fallback',
          oldChat: document.getElementById('endpoints')?.dataset.oldChat || '/api/fallback',
          oldSnippet: document.getElementById('endpoints')?.dataset.oldSnippet || '/api/fallback',
          executeTwoSum: document.getElementById('endpoints')?.dataset.executeTwoSum || '/api/fallback'
        };

        // Optional: Re-add error handling if needed, now using this.ENDPOINTS
        Object.keys(this.ENDPOINTS).forEach(key => {
          logApiCall('Endpoint config', { key, value: this.ENDPOINTS[key] });
          if (!this.ENDPOINTS[key] || this.ENDPOINTS[key].includes('/api/fallback')) { // Check if it used fallback
            //console.warn(`Endpoint for ${key} might be using a fallback or is not configured: ${this.ENDPOINTS[key]}`);
          }
        });

        this.initializeTowerDefense();
        this.attachSolutionButtonListeners();
    }

    attachSolutionButtonListeners() {
        const clearOldBtn = document.getElementById('clear-old');
        const clearNewBtn = document.getElementById('clear-new');
        const clearBothBtn = document.getElementById('clear-both');
        const toggleBothBtn = document.getElementById('toggle-both');
        if (clearOldBtn) clearOldBtn.onclick = () => { builtSolutionOld = [...TWO_SUM_SKELETON]; this.updateSolutionPreview(); };
        if (clearNewBtn) clearNewBtn.onclick = () => { builtSolutionNew = [...TWO_SUM_SKELETON]; this.updateSolutionPreview(); };
        if (clearBothBtn) clearBothBtn.onclick = () => { builtSolutionOld = [...TWO_SUM_SKELETON]; builtSolutionNew = [...TWO_SUM_SKELETON]; this.updateSolutionPreview(); };
        if (toggleBothBtn) toggleBothBtn.onclick = () => {
            const oldDiv = document.getElementById('old-solution-preview');
            const newDiv = document.getElementById('solution-preview');
            if (oldDiv && newDiv) {
                if (oldDiv.style.display === 'none') {
                    oldDiv.style.display = '';
                    newDiv.style.display = '';
                } else {
                    oldDiv.style.display = 'none';
                    newDiv.style.display = 'block';
                }
            }
        };
    }

    async initializeTowerDefense() {
        logApiCall('initializeTowerDefense', {});
        // Initialize tower selection
        const towerSelect = document.getElementById('tower-select');
        // REMOVE: updateTowerInfo on dropdown change
        // if (towerSelect) {
        //     towerSelect.addEventListener('change', () => this.updateTowerInfo());
        // }
        // Instead, just update tower info display (no snippet generation)
        if (towerSelect) {
            towerSelect.addEventListener('change', () => this.updateTowerInfo());
        }

        // Initialize add tower button
        const addTowerBtn = document.getElementById('add-tower');
        if (addTowerBtn) {
            addTowerBtn.addEventListener('click', () => this.addTower());
        }

        // Initialize test solution button
        const testSolutionBtn = document.getElementById('test-solution');
        if (testSolutionBtn) {
            testSolutionBtn.addEventListener('click', () => this.testSolution());
        }

        // Initialize hack assistant
        this.initializeHackAssistant();

        // Add clear/toggle buttons for solutions
        this.addSolutionButtons();

        // Initial tower info update (show instructional message on page load)
        this.updateTowerInfo();
    }

    addSolutionButtons() {
        // Move rate limit info area next to the Add Tower button
        let infoDiv = document.getElementById('rate-limit-info');
        if (!infoDiv) {
            infoDiv = document.createElement('div');
            infoDiv.id = 'rate-limit-info';
            infoDiv.className = 'ml-4 inline-block align-middle text-sm text-gray-600';
        }
        // Insert next to the Add Tower button
        const addTowerBtn = document.getElementById('add-tower');
        if (addTowerBtn && addTowerBtn.parentNode) {
            // If not already inserted, insert after the Add Tower button
            if (addTowerBtn.nextSibling !== infoDiv) {
                addTowerBtn.parentNode.insertBefore(infoDiv, addTowerBtn.nextSibling);
            }
        }
        // Add clear/toggle buttons and old solution area if not present
        if (!document.getElementById('old-solution-preview')) {
            const solutionDiv = document.getElementById('solution-preview');
            if (!solutionDiv) return; // Defensive: don't proceed if missing
            const container = solutionDiv.parentNode;
            // Create flex wrapper
            const flexWrapper = document.createElement('div');
            flexWrapper.className = 'solution-flex-row';
            // Create oldDiv
            const oldDiv = document.createElement('div');
            oldDiv.id = 'old-solution-preview';
            oldDiv.className = 'bg-slate-800 text-blue-400 rounded p-4 min-h-[3rem] text-base mb-2';
            oldDiv.style.marginTop = '1rem';
            // Remove inline-block/width styles
            oldDiv.style.display = '';
            oldDiv.style.width = '';
            solutionDiv.style.display = '';
            solutionDiv.style.width = '';
            // Insert both into flex wrapper
            flexWrapper.appendChild(oldDiv);
            flexWrapper.appendChild(solutionDiv);
            // Only insert if solutionDiv is still a child of container
            if (solutionDiv.parentNode === container) {
                container.insertBefore(flexWrapper, solutionDiv);
                container.removeChild(solutionDiv);
            } else {
                // fallback: just append flexWrapper after container
                container.appendChild(flexWrapper);
            }
            // Add clear/toggle buttons
            const btnDiv = document.createElement('div');
            btnDiv.className = 'mb-2';
            btnDiv.innerHTML = `
                <button id="clear-old" class="mr-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-1 px-2 rounded">Clear Old</button>
                <button id="clear-new" class="mr-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-1 px-2 rounded">Clear New</button>
                <button id="clear-both" class="mr-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-1 px-2 rounded">Clear Both</button>
                <button id="toggle-both" class="bg-blue-200 hover:bg-blue-300 text-blue-800 font-semibold py-1 px-2 rounded">Show/Hide Both</button>
            `;
            container.parentNode.insertBefore(btnDiv, container);
        }
    }

    async updateTowerInfo() {
        logApiCall('updateTowerInfo - start', {});
        const towerType = document.getElementById('tower-select')?.value;
        const towerInfoElement = document.getElementById('tower-info');
        if (!towerType || !towers[towerType]) {
            if (towerInfoElement) {
                towerInfoElement.innerHTML = `<div class='text-gray-500'>Select a tower from the dropdown to see in-game stats and what they do.</div>`;
            }
            logApiCall('updateTowerInfo - no towerType', { towerType });
            return;
        }
        // Only update tower info display, do NOT fetch/generate snippets
        const tower = towers[towerType];
        if (towerInfoElement && tower) {
            towerInfoElement.innerHTML =
                `<div class='mb-2'><span class='font-bold'>${tower.name}</span>: ${tower.desc}</div>` +
                `<div class='mb-2'>Cost: <span class='font-semibold'>${tower.cost} BITS</span> | DMG: <span class='font-semibold'>${tower.dmg}</span> | RNG: <span class='font-semibold'>${tower.rng}</span> | SPD: <span class='font-semibold'>${tower.spd}</span></div>` +
                `<div class='mb-2'>Upgrades: <span class='text-xs'>${tower.upgrades.join(', ')}</span></div>`;
        }
        logApiCall('updateTowerInfo - end', { towerType, tower });
    }

    async addTower() {
        logApiCall('addTower - start', {});
        const towerType = document.getElementById('tower-select').value;
        const addTowerBtn = document.getElementById('add-tower');
        if (addTowerBtn) {
            // Store original button text
            const originalText = addTowerBtn.textContent;
            // Add spinner markup if not present
            if (!addTowerBtn.querySelector('.spinner')) {
                const spinner = document.createElement('span');
                spinner.className = 'spinner';
                addTowerBtn.appendChild(spinner);
            }
            addTowerBtn.classList.add('button--loading');
            addTowerBtn.disabled = true;
        }
        // Only send the code body (indented lines after the skeleton) for snippet generation
        const codeBody = builtSolutionNew.slice(TWO_SUM_SKELETON.length).join('\n');
        const context = {
            problem: {
                title: "Two Sum",
                description: "Given an array of integers nums and an integer target, return indices of the two numbers such that they add up to target."
            },
            language: "Python",
            // Always send the full skeleton plus code body for context
            code: [...TWO_SUM_SKELETON, ...builtSolutionNew.slice(TWO_SUM_SKELETON.length)].join('\n')
        };
        setSnippetLoading();
        try {
            logApiCall('addTower - fetch oldSnippet', { url: this.ENDPOINTS.oldSnippet, towerType, context });
            // Fetch old snippet for comparison
            const oldResponse = await fetch(this.ENDPOINTS.oldSnippet, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    towerType,
                    context
                })
            });
            logApiCall('addTower - oldSnippet response', { status: oldResponse.status });
            const oldData = await handleApiResponse(oldResponse, 'old');
            const oldSnippetElement = document.getElementById('old-snippet');
            if (oldSnippetElement) {
                oldSnippetElement.textContent = oldData.snippet || (oldData.error || 'No snippet returned.');
            }
            if (oldData.snippet) {
                builtSolutionOld.push('        ' + oldData.snippet.trim());
            } else {
                builtSolutionOld.push(`# Error: ${oldData.error || 'No snippet returned.'}`);
            }
            // Fetch new snippet and add to solution
            logApiCall('addTower - fetch newSnippet', { url: this.ENDPOINTS.newSnippet, towerType, context });
            const newResponse = await fetch(this.ENDPOINTS.newSnippet, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    towerType,
                    context
                })
            });
            logApiCall('addTower - newSnippet response', { status: newResponse.status });
            const newData = await handleApiResponse(newResponse, 'new');
            const newSnippetElement = document.getElementById('new-snippet');
            if (newSnippetElement) {
                newSnippetElement.textContent = newData.snippet || (newData.error || 'No snippet returned.');
            }
            if (newData.snippet) {
                builtSolutionNew.push('        ' + newData.snippet.trim());
            } else {
                builtSolutionNew.push(`# Error: ${newData.error || 'No snippet returned.'}`);
            }
            this.updateSolutionPreview();
            logApiCall('addTower - end', { oldData, newData });
        } catch (error) {
            console.error('Error adding tower:', error);
            logApiCall('addTower - error', { error });
            builtSolutionNew.push(`# Error: Could not add tower. Please try again.`);
            this.updateSolutionPreview();
        } finally {
            if (addTowerBtn) {
                addTowerBtn.classList.remove('button--loading');
                addTowerBtn.disabled = false;
                // Remove spinner if it exists
                const spinner = addTowerBtn.querySelector('.spinner');
                if (spinner) {
                    spinner.remove();
                }
            }
        }
    }

    updateSolutionPreview() {
        logApiCall('updateSolutionPreview', { builtSolutionOld, builtSolutionNew });
        // Update the old solution preview
        const oldDiv = document.getElementById('old-solution-preview');
        if (oldDiv) {
            oldDiv.innerHTML = `<h4 class=\"font-semibold text-blue-700 dark:text-blue-600 mb-2\">Old Code</h4>\n<pre class=\"bg-slate-900 text-blue-400 rounded p-4 min-h-[2.5rem] text-base mb-2\" style=\"overflow-x: auto; white-space: pre; font-family: 'Consolas', 'Monaco', 'Courier New', monospace;\">${builtSolutionOld.length ? builtSolutionOld.join('\n\n') : ''}</pre>`;
        }
        // Update the new solution preview
        const newDiv = document.getElementById('solution-preview');
        if (newDiv) {
            newDiv.innerHTML = `<h4 class=\"font-semibold text-green-700 dark:text-green-800 mb-2\">New Code</h4>\n<pre class=\"bg-slate-900 text-green-400 rounded p-4 min-h-[2.5rem] text-base mb-2\" style=\"overflow-x: auto; white-space: pre; font-family: 'Consolas', 'Monaco', 'Courier New', monospace;\">${builtSolutionNew.length ? builtSolutionNew.join('\n\n') : ''}</pre>`;
        }
    }

    async testSolution() {
        logApiCall('testSolution - start', {});
        const testBtn = document.getElementById('test-solution');
        const resultDiv = document.getElementById('test-result');
        if (testBtn) {
            testBtn.classList.add('button--loading');
        }
        if (resultDiv) {
            resultDiv.innerHTML = '';
        }
        // Add spinner markup if not present
        if (testBtn && !testBtn.querySelector('.spinner')) {
            const spinner = document.createElement('span');
            spinner.className = 'spinner';
            testBtn.appendChild(spinner);
        }
        let retryCount = 0;
        const maxRetries = 20; // ~1 minute
        const pollAndRetry = async () => {
            try {
                // Always send the full code (skeleton + all lines) for testing
                const solution = builtSolutionNew.join('\n');
                logApiCall('testSolution - fetch', { url: this.ENDPOINTS.executeTwoSum, solution });
                const response = await fetch(this.ENDPOINTS.executeTwoSum, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ code: solution })
                });
                logApiCall('testSolution - response', { status: response.status });
                const data = await handleApiResponse(response, 'execute');
                if (data.error && data.error.includes('Judge0 VM is not ready')) {
                    if (resultDiv) {
                        resultDiv.innerHTML = `<span style='color:#fbbf24;'>⏳ Judge0 VM is starting up. Please wait... (Attempt ${retryCount + 1})</span>`;
                    }
                    if (retryCount < maxRetries) {
                        retryCount++;
                        setTimeout(pollAndRetry, 3000);
                    } else {
                        if (resultDiv) {
                            resultDiv.innerHTML = `<span style='color:#f87171;'>❌ Error: Judge0 VM is still not ready after multiple attempts. Please try again later.</span>`;
                        }
                        if (testBtn) testBtn.classList.remove('button--loading');
                    }
                    return;
                }
                if (data.all_passed) {
                    resultDiv.innerHTML = '<span style="color:#22c55e;">✅ Success! Your solution passed all test cases.</span>';
                } else if (data.results && data.results.length > 0) {
                    // Show error details for failed test cases
                    let errorHtml = '<span style="color:#f87171;">❌ Some test cases failed.</span><ul style="color:#f87171;">';
                    data.results.forEach(r => {
                        if (!r.passed) {
                            errorHtml += `<li>Test ${r.test_case}: `;
                            if (r.error) {
                                errorHtml += `<pre style='white-space: pre-wrap;'>${r.error}</pre>`;
                            } else {
                                errorHtml += 'Incorrect output.';
                            }
                            errorHtml += '</li>';
                        }
                    });
                    errorHtml += '</ul>';
                    resultDiv.innerHTML = errorHtml;
                } else if (data.error) {
                    resultDiv.innerHTML = `<span style='color:#f87171;'>❌ Error: ${data.error}</span>`;
                } else {
                    resultDiv.innerHTML = '<span style="color:#f87171;">❌ Oops! Your solution is incomplete or has a bug. Try using more towers or ask the Hack Assistant for help.</span>';
                }
                logApiCall('testSolution - end', { data });
                if (testBtn) testBtn.classList.remove('button--loading');
            } catch (error) {
                // If the error is Judge0 VM is not ready, retry
                if (error && error.message && error.message.includes('Judge0 VM is not ready')) {
                    if (resultDiv) {
                        resultDiv.innerHTML = `<span style='color:#fbbf24;'>⏳ Judge0 VM is starting up. Please wait... (Attempt ${retryCount + 1})</span>`;
                    }
                    if (retryCount < maxRetries) {
                        retryCount++;
                        setTimeout(pollAndRetry, 3000);
                    } else {
                        if (resultDiv) {
                            resultDiv.innerHTML = `<span style='color:#f87171;'>❌ Error: Judge0 VM is still not ready after multiple attempts. Please try again later.</span>`;
                        }
                        if (testBtn) testBtn.classList.remove('button--loading');
                    }
                    return;
                }
                // Otherwise, show a generic error
                console.error('Error testing solution:', error);
                logApiCall('testSolution - error', { error });
                if (resultDiv) {
                    resultDiv.innerHTML = `<span style='color:#f87171;'>❌ Error: Could not test solution. Please try again.</span>`;
                }
                if (testBtn) testBtn.classList.remove('button--loading');
            }
        };
        pollAndRetry();
    }

    initializeHackAssistant() {
        logApiCall('initializeHackAssistant', {});
        const transmitBtn = document.getElementById('transmit-btn-static');
        const hackInput = document.getElementById('hack-input-static');
        const assistLevel = document.getElementById('assist-level-static');
        const chatMsg = document.getElementById('hack-chat-msg-static');
        const chatBox = document.getElementById('hack-chat-static');

        // Add a scrollable chat log div if not present
        if (!document.getElementById('hack-chat-log')) {
            const chatLog = document.createElement('div');
            chatLog.id = 'hack-chat-log';
            chatLog.style.maxHeight = '200px';
            chatLog.style.overflowY = 'auto';
            chatLog.style.padding = '0.5rem 0';
            chatLog.className = 'text-sm';
            chatBox.innerHTML = '';
            chatBox.appendChild(chatLog);
        }
        this.renderHackChatHistory();

        if (transmitBtn && hackInput) {
            transmitBtn.onclick = async () => {
                const query = hackInput.value.trim();
                if (!query) return;
                transmitBtn.classList.add('button--loading');
                // Add spinner if not present
                if (!transmitBtn.querySelector('.spinner')) {
                    const spinner = document.createElement('span');
                    spinner.className = 'spinner';
                    transmitBtn.appendChild(spinner);
                }
                hackChatHistory.push({ role: 'user', content: query });
                this.renderHackChatHistory();
                logApiCall('HackAssistant - user query', { query, assistLevel: assistLevel.value });
                try {
                    logApiCall('HackAssistant - fetch', { url: this.ENDPOINTS.newChat, query, assistLevel: assistLevel.value });
                    // --- FIX: Map dropdown value to backend key ---
                    const assistLevelMap = {
                        "Hints Only - Get hints and guidance, but never full code.": "hints_only",
                        "Full Solution - Receive a complete code solution.": "full_solution",
                        "Step-by-Step - Get a solution broken down into logical steps.": "step_by_step",
                        "Debug Mode - Get help identifying and fixing bugs in your code.": "debug_mode",
                        "Learning Mode - Get explanations and teaching for concepts and code.": "learning_mode",
                        "Chat": "chat"
                    };
                    const selectedLevel = assistLevelMap[assistLevel.value] || "hints_only";
                    // --- END FIX ---
                    const response = await fetch(this.ENDPOINTS.newChat, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            messages: hackChatHistory.map(m => ({ role: m.role, content: m.content })),
                            assistanceLevel: selectedLevel
                        })
                    });
                    logApiCall('HackAssistant - response', { status: response.status });
                    const data = await handleApiResponse(response, 'newChat');
                    // Use markdown parser for assistant response
                    hackChatHistory.push({ role: 'assistant', content: data.response?.content || data.response || data.error || 'No response.' });
                    this.renderHackChatHistory();
                    hackInput.value = '';
                    logApiCall('HackAssistant - end', { data });
                } catch (error) {
                    console.error('Error getting hack assistant response:', error);
                    logApiCall('HackAssistant - error', { error });
                    hackChatHistory.push({ role: 'assistant', content: 'Error: Could not get response from Hack Assistant. Please try again.' });
                    this.renderHackChatHistory();
                } finally {
                    transmitBtn.classList.remove('button--loading');
                }
            };
        }
    }

    renderHackChatHistory() {
        const chatLog = document.getElementById('hack-chat-log');
        if (!chatLog) return;
        chatLog.innerHTML = '';
        hackChatHistory.forEach(msg => {
            const msgDiv = document.createElement('div');
            msgDiv.className = msg.role === 'user' ? 'text-right mb-2' : 'text-left mb-2';
            if (msg.role === 'user') {
                msgDiv.innerHTML = `<span class='inline-block bg-blue-200 text-blue-900 rounded px-2 py-1' style='max-width: 90%; word-break: break-word; white-space: pre-wrap; overflow-wrap: anywhere;'>${msg.content}</span>`;
            } else {
                // Use marked.js for markdown rendering
                msgDiv.innerHTML = `<span class='block bg-purple-100 text-purple-900 rounded px-2 py-1 w-full' style='width: 100%; white-space: pre-wrap; word-break: break-word; overflow-wrap: anywhere; box-sizing: border-box;'>${window.marked ? marked.parse(msg.content) : msg.content}</span>`;
            }
            chatLog.appendChild(msgDiv);
        });
        // Scroll to bottom
        chatLog.scrollTop = chatLog.scrollHeight;
    }
}

// Initialize when DOM is loaded
// Add rate limit info area if not present
if (!document.getElementById('rate-limit-info')) {
    const infoDiv = document.createElement('div');
    infoDiv.id = 'rate-limit-info';
    infoDiv.className = 'mb-4 text-sm text-gray-600';
    const parent = document.querySelector('.mb-4') || document.body;
    parent.parentNode.insertBefore(infoDiv, parent.nextSibling);
}
document.addEventListener('DOMContentLoaded', () => {
    if (!window.marked) {
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/marked/marked.min.js';
        script.onload = () => { 
            const ie = new InteractiveElements();
            ie.attachSolutionButtonListeners();
        };
        document.body.appendChild(script);
    } else {
        const ie = new InteractiveElements();
        ie.attachSolutionButtonListeners();
    }
});
</script>

<!-- Code block styling enhancements -->
<script>
// Add copy button to code blocks
document.addEventListener('DOMContentLoaded', () => {
    const codeBlocks = document.querySelectorAll('.highlight');
    
    codeBlocks.forEach((block) => {
        // Create copy button
        const copyButton = document.createElement('button');
        copyButton.className = 'copy-code-button absolute top-2 right-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded px-2 py-1 text-xs font-mono';
        copyButton.textContent = 'Copy';
        
        // Position the code block container relatively
        block.style.position = 'relative';
        
        // Add button to block
        block.appendChild(copyButton);
        
        // Add click event
        copyButton.addEventListener('click', () => {
            const code = block.querySelector('code').innerText;
            navigator.clipboard.writeText(code);
            
            // Visual feedback
            copyButton.textContent = 'Copied!';
            copyButton.classList.add('bg-green-200', 'dark:bg-green-800', 'text-green-800', 'dark:text-green-200');
            
            // Reset after 2 seconds
            setTimeout(() => {
                copyButton.textContent = 'Copy';
                copyButton.classList.remove('bg-green-200', 'dark:bg-green-800', 'text-green-800', 'dark:text-green-200');
            }, 2000);
        });
    });
});
</script>

<style>
/* Specific styling for code blocks in posts */
.post-content .highlight {
    margin: 2rem 0;
}

/* Style for code copy button on hover */
.copy-code-button {
    opacity: 0;
    transition: opacity 0.2s ease-in-out;
}

.highlight:hover .copy-code-button {
    opacity: 1;
}
</style> 
    </main>
    
     <!-- This is to prevent the footer ad from appearing on the home page need to also hide on privacy policy page -->
    
<div class="footer-ad-container w-full py-4 bg-gray-50 border-t border-gray-200 mt-8 border-2 border-dashed border-gray-300">
  <div class="container mx-auto px-4 text-center">
    <h4 class="text-sm uppercase text-gray-500 mb-2 text-center">Advertisement</h4>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-7733001105026476"
         data-ad-slot="7978772768"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </div>
</div>
 
    
    
    <footer class="bg-gray-900 text-white py-12" role="contentinfo">
  <div class="container mx-auto px-4">
    <div class="flex flex-wrap">
      <div class="w-full lg:w-1/3 mb-8 lg:mb-0">
        <h2 class="text-xl font-bold mb-4 text-gray-400">Riviera Sperduto - Developer Portfolio</h2>
        <p class="text-gray-400">A collection of my software development projects, skills, and services.</p>
        
        <div class="mt-4 flex space-x-4">
          <a href="https://github.com/rivie13" target="_blank" class="text-gray-400 hover:text-white" aria-label="GitHub profile">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path>
            </svg>
          </a>
          <a href="https://www.linkedin.com/in/" target="_blank" class="text-gray-400 hover:text-white" aria-label="LinkedIn profile">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path>
            </svg>
          </a>
          <a href="mailto:riviera.t.sperduto13@gmail.com" class="text-gray-400 hover:text-white" aria-label="Send email">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.4 4.25l-7.07 4.42c-.32.2-.74.2-1.06 0L4.4 8.25c-.25-.16-.4-.43-.4-.72 0-.67.73-1.07 1.3-.72L12 11l6.7-4.19c.57-.35 1.3.05 1.3.72 0 .29-.15.56-.4.72z"></path>
            </svg>
          </a>
        </div>
      </div>
      
      <div class="w-full lg:w-1/3 mb-8 lg:mb-0">
        <h2 class="text-xl font-bold mb-4 text-gray-400">Quick Links</h2>
        <nav role="navigation" aria-label="Footer navigation">
          <ul class="text-gray-400">
            <li class="mb-2"><a href="/" class="hover:text-white">Home</a></li>
            <li class="mb-2"><a href="/about/" class="hover:text-white">About</a></li>
            <li class="mb-2"><a href="/projects/" class="hover:text-white">Projects</a></li>
            <li class="mb-2"><a href="/services/" class="hover:text-white">Services</a></li>
            <li class="mb-2"><a href="/resume/" class="hover:text-white">Resume</a></li>
            <li class="mb-2"><a href="/blog/" class="hover:text-white">Blog</a></li>
            <li class="mb-2"><a href="/contact/" class="hover:text-white">Contact</a></li>
          </ul>
        </nav>
      </div>
      
      <div class="w-full lg:w-1/3">
        <h2 class="text-xl font-bold mb-4 text-gray-400">Contact</h2>
        <p class="text-gray-400 mb-2">
          <span class="inline-block mr-2">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.4 4.25l-7.07 4.42c-.32.2-.74.2-1.06 0L4.4 8.25c-.25-.16-.4-.43-.4-.72 0-.67.73-1.07 1.3-.72L12 11l6.7-4.19c.57-.35 1.3.05 1.3.72 0 .29-.15.56-.4.72z"></path>
            </svg>
          </span>
          <a href="mailto:riviera.t.sperduto13@gmail.com" class="hover:text-white">riviera.t.sperduto13@gmail.com</a>
        </p>
        <p class="text-gray-400">
          <span class="inline-block mr-2">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm0 22c-5.5 0-10-4.5-10-10s4.5-10 10-10 10 4.5 10 10-4.5 10-10 10zm-1-14v7.59l5.293 5.3 1.414-1.42-4.707-4.71v-6.76h-2z"></path>
            </svg>
          </span>
          Available for freelance projects
        </p>
      </div>
    </div>
    
    <div class="mt-8 pt-8 border-t border-gray-800 text-center text-gray-400">
      <p>&copy; 2025 Riviera Sperduto - Developer Portfolio. All rights reserved.</p>
    </div>
  </div>
</footer> 
    
    <!-- Load scripts in proper dependency order -->
    <script src="/assets/js/github-config.js"></script>
    <script src="/assets/js/github-repos.js"></script>
    <script src="/assets/js/github-activity.js"></script>
    <script src="/assets/js/github-stats.js"></script>
    <script src="/assets/js/github-contributions.js"></script>
    <script src="/assets/js/project-cards.js"></script>
    <script src="/assets/js/github-test.js"></script>
    <script src="/assets/js/main.js"></script>
    <script src="/assets/js/animations.js"></script>
    <script src="/assets/js/responsive.js"></script>
    
    <!-- Cookie Consent Banner -->
<style>
    #cookie-notice {
        padding: 20px;
        display: none;
        text-align: center;
        position: fixed;
        bottom: 0;
        width: 100%;
        background: #222;
        color: rgba(255, 255, 255, 0.8);
        z-index: 1000;
    }

    #cookie-notice a {
        display: inline-block;
        cursor: pointer;
        margin-left: 10px;
    }

    #cookie-notice #cookie-notice-accept {
        background-color: #4CAF50;
        color: white;
        padding: 8px 18px;
        border-radius: 5px;
        text-decoration: none;
    }

    #cookie-notice #cookie-notice-deny {
        background-color: #f44336;
        color: white;
        padding: 8px 18px;
        border-radius: 5px;
        text-decoration: none;
    }

    #cookie-notice #cookie-notice-info {
        color: rgba(255, 255, 255, 0.8);
        text-decoration: underline;
    }

    @media (max-width: 767px) {
        #cookie-notice {
            padding: 15px;
        }
        #cookie-notice a {
            display: block;
            margin: 8px auto;
            max-width: 170px;
        }
    }
</style>
<div id="cookie-notice">
    <span>I would like to use cookies to improve your experience on my website and to analyze site traffic.</span>
    <a id="cookie-notice-accept">Accept</a>
    <a id="cookie-notice-deny">Deny</a>
    <a id="cookie-notice-info" href="/privacy">More info</a>
</div>

<script>
    function createCookie(name, value, days) {
        var expires = "";
        if (days) {
            var date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + value + expires + "; path=/";
    }

    function readCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';');
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) == ' ') c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
    }

    function loadAnalytics() {
        // Load GA script
        var script = document.createElement('script');
        script.innerHTML = `/*This function will load script and call the callback once the script has loaded*/

function loadScriptAsync(scriptSrc, callback) {
    if (typeof callback !== 'function') {
        throw new Error('Not a valid callback for async script load');
    }
    var script = document.createElement('script');
    script.onload = callback;
    script.src = scriptSrc;
    document.head.appendChild(script);
}

/* This is the part where you call the above defined function and "calls back" your code which gets executed after the script has loaded */

loadScriptAsync('https://www.googletagmanager.com/gtag/js?id=G-C9WDHTWS34', function () {
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-C9WDHTWS34', { 'anonymize_ip': true });
}) `;
        document.head.appendChild(script);
    }

    function eraseCookie(name) {
        createCookie(name, "", -1);
    }

    // Show the cookie notice if consent hasn't been given
    document.addEventListener('DOMContentLoaded', function () {
        // Check if we need to show the notice (only in production)
        /*  */
    });

    // Button click handlers
    document.getElementById('cookie-notice-accept').addEventListener('click', function () {
        createCookie('cookie-notice-dismissed', 'true', 365);
        document.getElementById('cookie-notice').style.display = 'none';
        loadAnalytics();
    });

    document.getElementById('cookie-notice-deny').addEventListener('click', function () {
        createCookie('cookie-notice-dismissed', 'false', 365);
        document.getElementById('cookie-notice').style.display = 'none';
    });
</script> 
</body>
</html> 